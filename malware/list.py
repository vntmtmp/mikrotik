import os
import requests

# Daftar URL yang berisi alamat IP malware
urls = [
    'https://feodotracker.abuse.ch/downloads/ipblocklist.txt',
    'https://malc0de.com/bl/IP_Blacklist.txt',
    'https://www.malwaredomainlist.com/hostslist/ip.txt'
]

# Daftar untuk menyimpan alamat IP
malware_ips = []

# Mengambil alamat IP dari setiap URL
for url in urls:
    response = requests.get(url)
    if response.status_code == 200:
        # Memisahkan alamat IP berdasarkan baris
        ips = response.text.strip().split('\n')
        malware_ips.extend(ips)

# Menghilangkan duplikat dan mengurutkan alamat IP
unique_malware_ips = sorted(set(malware_ips))

# Membuat file .rsc
destination = '/var/www/html/malware-block.rsc'
with open(destination, 'w') as file:
    file.write('/ip firewall address-list\n')
    for ip in unique_malware_ips:
        file.write(f"add address={ip} comment=\"Malware IP from Feodo, Malc0de, MalwareDomainList\"\n")

print(f"File {destination} telah dibuat dengan {len(unique_malware_ips)} alamat IP malware.")
